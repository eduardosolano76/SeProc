<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Módulo Admin</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  

  <style>
    :root{
      --orange: #c66a00;
      --orange-2:#b55f00;
      --active: #7a6049;     /* iluminado/seleccionado */
      --bg: #ffffff;
      --panel: #eceae6;      /* recuadro gris grande */
      --text: #111;
      --muted:#6c6c6c;
      --radius: 34px;
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }

    body{
       margin:0;
       font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
       background: var(--bg);
       color: var(--text);
       }

    /* ===== Layout ===== */
    .layout{
      display:flex;
      min-height:100vh;
      width:100%;
    }

    /* ===== Sidebar ===== */
    .sidebar{
      width: 300px;
      background: var(--orange);
      padding: 26px 0;
      display:flex;
      flex-direction:column;
      gap: 22px;
    }

    .brand{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 14px;
      padding: 0 18px;
    }

    /* ===== Aquí se modifica el tamaño del logo en el menú===== */

    .brand .logo{
  width: 130px;
  height: 130px;
  border-radius: 50%;
  background:#fff;
  overflow:hidden;
  border: 6px solid #fff;
  outline: 4px solid rgba(255,255,255,.25);
  box-shadow: 0 10px 26px rgba(0,0,0,.18);
  display:grid;
  place-items:center;
}

    .brand .logo img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .nav{
      margin-top: 12px;
      display:flex;
      flex-direction:column;
      gap: 8px;
    }

    .nav-item{
      width:100%;
      border:none;
      background: transparent;
      color:#fff;
      text-align:left;
      padding: 16px 18px;
      cursor:pointer;

      display:flex;
      align-items:center;
      gap: 14px;

      font-size: 18px;
      border-radius: 0;
      transition: background .15s ease;
    }

    /* hover como tu imagen */
    .nav-item:hover{
      background: var(--active);
    }
    .nav-item.active{
      background: var(--active);
    }

    .nav-item .icon{
      width: 28px;
      height: 28px;
      display:grid;
      place-items:center;
      flex: 0 0 28px;
    }

    .nav-item .icon img{
      width: 26px;
      height: 26px;
      object-fit: contain;
      display:block;
      filter: brightness(0) invert(1); /* iconos blancos */
    }

    .nav-item .label{
      flex:1;
      font-weight: 500;
      position: relative;
      top: 4px;
    }

    .nav-item .chev{
      width: 18px;
      height: 18px;
      display:grid;
      place-items:center;
      opacity: .9;
      transition: transform .15s ease;
    }

    .nav-item .chev img{
      width: 16px;
      height: 16px;
      object-fit: contain;
      filter: brightness(0) invert(1);
    }

    .nav-item[data-open="true"] .chev{
      transform: rotate(180deg);
    }

    /* ===== Submenu ===== */
    .submenu{
      display:none;
      flex-direction:column;
      gap: 6px;
      padding: 0 0 10px 60px;
      margin-top: -6px;
    }

    .submenu.open{ display:flex; }

    .sub-item{
      width: calc(100% - 18px);
      background: transparent;
      border: none;
      color:#fff;
      text-align:left;
      padding: 10px 12px;
      border-radius: 10px;
      font-size: 16px;
      cursor:pointer;
      transition: background .15s ease;
    }

    .sub-item:hover{ background: rgba(255,255,255,.14); }

    .sub-item.active{
      background: rgba(255,255,255,.18);
      font-weight: 800;
    }

    /* ===== Content ===== */
    .content{
      flex: 1;
      padding: 22px 26px 26px;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      }


    /* Topbar */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 18px;
      padding: 6px 8px 14px;
    }

    .search{
      flex: 1;
      max-width: 420px;
      position: relative;
    }

    .search input{
      width: 100%;
      height: 44px;
      border:none;
      outline:none;
      border-radius: 999px;
      background: #e9e7e3;
      padding: 0 16px 0 44px;
      font-size: 16px;
    }

    .search .s-icon{
      position:absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      width: 18px;
      height: 18px;
      opacity: .85;
    }

    .search .s-icon img{
      width: 18px;
      height: 18px;
      object-fit: contain;
      display:block;
    }

    .userbox{
      display:flex;
      align-items:center;
      gap: 14px;
      white-space: nowrap;
    }

    .userbox .hello{
      font-size: 28px;
      font-weight: 500;
    }

    /* Perfil para subir imagen */
    .profile{
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background:#fff;
      border: 2px solid #000;
      overflow:hidden;
      display:grid;
      place-items:center;
      cursor:pointer;
      padding: 0;
    }

    .profile img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }

    /* Panel gris */
    .panel{
      background: var(--panel);
      border-radius: var(--radius);
      padding: 24px 26px;
      flex: 1;        
      min-height: 0;  
}


    .panel-head{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 14px;
      margin-bottom: 10px;
    }

    .panel-title{
      font-size: 22px;
      font-weight: 800;
      margin: 0;
    }

    .panel-sub{
      margin-top: 18px;
      color: var(--muted);
      font-size: 16px;
    }

    /* Botón agregar usuario */
    .add-btn{
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border:none;
      background: var(--orange);
      cursor:pointer;
      display:grid;
      place-items:center;
      box-shadow: 0 6px 18px rgba(0,0,0,.12);
    }

    .add-btn img{
      width: 24px;
      height: 24px;
      object-fit: contain;
      filter: brightness(0) invert(1);
    }

    .add-btn:hover{ background: var(--orange-2); }

    /* Responsive básico */
    @media (max-width: 1024px){
      .sidebar{ width: 260px; }
      .userbox .hello{ font-size: 22px; }
    }

    @media (max-width: 768px){
      .layout{ flex-direction:column; }

      .sidebar{
        width: 100%;
        flex-direction:row;
        align-items:center;
        justify-content:space-between;
        padding: 14px;
      }

      .brand{ flex-direction:row; }
      .nav{ flex-direction:row; gap: 6px; margin-top:0; }
      .nav-item{ padding: 12px 12px; font-size: 16px; }
      .nav-item .label{ display:none; }

      .submenu{
        position:absolute;
        left: 14px;
        top: 120px;
        background: rgba(0,0,0,.15);
        padding: 10px;
        border-radius: 14px;
      }

      .content{ padding: 16px; }
      .panel{ min-height: 520px; }
    }
  </style>
</head>

<body>
<div class="layout">

  <!-- ===== SIDEBAR ===== -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo">
        <img th:src="@{/assets/logo.jpg}" alt="Logo">
      </div>
    </div>

    <nav class="nav" aria-label="Menú Admin">

      <!-- Proyectos -->
      <button class="nav-item" id="navProyectos" type="button" data-view="proyectos">
        <span class="icon">
          <img th:src="@{/assets/iconos/proyectos.png}" alt="">
        </span>
        <span class="label">Proyectos</span>
      </button>

      <!-- Usuarios con desplegable -->
      <button class="nav-item" id="navUsuarios" type="button" data-open="false">
        <span class="icon">
          <img th:src="@{/assets/iconos/usuarios.png}" alt="">
        </span>
        <span class="label">Usuarios</span>
        <span class="chev" aria-hidden="true">
          <img th:src="@{/assets/iconos/desplegable.png}" alt="">
        </span>
      </button>

      <div class="submenu" id="submenuUsuarios">
        <button class="sub-item active" type="button" data-view="usuarios-supervisores">Supervisores</button>
        <button class="sub-item" type="button" data-view="usuarios-constructores">Constructores</button>
        <button class="sub-item" type="button" data-view="usuarios-directores">Directores</button>
      </div>

      <!-- Cerrar sesión -->
      <form th:action="@{/logout}" method="post" style="margin:0;">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <button class="nav-item" id="navLogout" type="submit">
          <span class="icon">
            <img th:src="@{/assets/iconos/salir.png}" alt="">
          </span>
          <span class="label">Cerrar Sesión</span>
        </button>
      </form>

    </nav>
  </aside>

  <!-- ===== CONTENT ===== -->
  <main class="content">

    <header class="topbar">
      <!-- Buscador pero solo es visual por ahora -->
      <div class="search" role="search">
        <span class="s-icon" aria-hidden="true">
          <img th:src="@{/assets/iconos/buscar.png}" alt="">
        </span>
        <input id="searchInput"
               type="search"
               placeholder="Buscar..."
               autocomplete="off"
               aria-label="Buscar por nombre, apellidos, proyecto, etc." />
      </div>

      <!-- Saludo + Perfil -->
      <div class="userbox">
        <div class="hello">
          Hola, <span th:text="${nombreUsuario != null ? nombreUsuario : 'Anette'}">Anette</span>!
        </div>

        <input id="profileFile" type="file" accept="image/*" hidden>

        <button class="profile" id="profileBtn" type="button" title="Cambiar foto">
          <img id="profileImg" alt="Foto de perfil" style="display:none;">
          <img id="profileFallback" th:src="@{/assets/iconos/usuarios.png}" alt="">
        </button>
      </div>
    </header>

    <!-- Panel grande recuadro gris -->
    <section class="panel" aria-label="Sección principal">
      <div class="panel-head">
        <div>
          <h2 class="panel-title" id="sectionTitle">Supervisores</h2>
        </div>

        <button class="add-btn" type="button" id="btnAdd" title="Agregar">
          <img th:src="@{/assets/iconos/agregar-usuario.png}" alt="">
        </button>
      </div>

      <div class="panel-sub" id="emptyText">No se ha registrado ningún usuario</div>

      <!-- Aquí después va la lista-->
      <div id="results" style="margin-top:14px;"></div>
    </section>

  </main>
</div>

<script>
  // ====== Panel ======
  const sectionTitle = document.getElementById('sectionTitle');
  const emptyText = document.getElementById('emptyText');
  const results = document.getElementById('results');

  const VIEWS = {
    "usuarios-supervisores": { title: "Supervisores", empty: "No se ha registrado ningún usuario" },
    "usuarios-constructores": { title: "Constructores", empty: "No se ha registrado ningún usuario" },
    "usuarios-directores": { title: "Directores", empty: "No se ha registrado ningún usuario" },
    "proyectos": { title: "Proyectos", empty: "No se ha registrado ningún proyecto" }
  };

  function setView(viewKey){
    const v = VIEWS[viewKey];
    if(!v) return;

    sectionTitle.textContent = v.title;
    emptyText.textContent = v.empty;

    results.innerHTML = "";
    emptyText.style.display = "block";
  }

  // ====== Active de botones (sidebar) ======
  function setActiveNav(buttonId){
    const allNav = document.querySelectorAll('.nav .nav-item');
    allNav.forEach(b => b.classList.remove('active'));
    const btn = document.getElementById(buttonId);
    if(btn) btn.classList.add('active');
  }

  // ====== Submenu Usuarios open/close ======
  const navUsuarios = document.getElementById('navUsuarios');
  const submenuUsuarios = document.getElementById('submenuUsuarios');

  navUsuarios?.addEventListener('click', () => {
    const isOpen = navUsuarios.getAttribute('data-open') === 'true';
    navUsuarios.setAttribute('data-open', String(!isOpen));
    submenuUsuarios.classList.toggle('open', !isOpen);

    setActiveNav('navUsuarios');
  });

  // ====== Click Proyectos ======
  document.getElementById('navProyectos')?.addEventListener('click', () => {
    setActiveNav('navProyectos');
    setView('proyectos');
  });

  // ====== Click sub-items Usuarios ======
  function setActiveSubItem(clicked){
    const all = document.querySelectorAll('#submenuUsuarios .sub-item');
    all.forEach(x => x.classList.remove('active'));
    clicked.classList.add('active');
  }

  document.querySelectorAll('#submenuUsuarios .sub-item').forEach(btn => {
    btn.addEventListener('click', () => {
      setActiveNav('navUsuarios');
      setActiveSubItem(btn);
      setView(btn.dataset.view);
    });
  });

  // ====== Foto de perfil para subir y previsualizar======
  const profileBtn = document.getElementById('profileBtn');
  const profileFile = document.getElementById('profileFile');
  const profileImg = document.getElementById('profileImg');
  const profileFallback = document.getElementById('profileFallback');

  profileBtn?.addEventListener('click', () => profileFile?.click());

  profileFile?.addEventListener('change', (e) => {
    const file = e.target.files && e.target.files[0];
    if(!file) return;

    const url = URL.createObjectURL(file);
    profileImg.src = url;
    profileImg.style.display = 'block';
    profileFallback.style.display = 'none';

  });

  // Botón agregar pero sin función ahorita
  document.getElementById('btnAdd')?.addEventListener('click', () => {
  });

  // ====== Vista inicial ======
setView("proyectos");
setActiveNav("navProyectos");
</script>

</body>
</html>
